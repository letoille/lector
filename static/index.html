<!DOCTYPE html>
<html>

<head>
    <title>Lector</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 2em;
        }

        #content {
            white-space: pre-wrap;
        }
    </style>
</head>

<body>
    <h1>文章抓取 Demo</h1>
    <form id="scrape-form">
        <input type="text" id="url" name="url" size="50" placeholder="输入文章 URL 抓取">
        <button type="submit">抓取</button>
    </form>
    <hr>
    <div id="metadata"></div>
    <h2 id="title"></h2>
    <div id="content"></div>

    <script>
        const form = document.getElementById('scrape-form');
        const title = document.getElementById('title');
        const content = document.getElementById('content');
        const metadata = document.getElementById('metadata');

        form.addEventListener('submit', async (event) => {
            event.preventDefault();
            const url = document.getElementById('url').value;
            content.textContent = 'Scraping...';
            title.textContent = '';
            metadata.textContent = '';

            const response = await fetch('/scrape', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ url })
            });

            const data = await response.json();
            title.textContent = data.title;
            content.textContent = data.markdown;
            
            let metadataText = '';
            if (data.author) {
                metadataText += `Author: ${data.author} `;
            }
            if (data.site_name) {
                metadataText += `Source: ${data.site_name} `;
            }
            if (data.published_time) {
                metadataText += `Published: ${data.published_time}`;
            }
            metadata.textContent = metadataText;
        });
    </script>
</body>

</html>